!function(t){function e(o){if(i[o])return i[o].exports;var r=i[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){"use strict";function i(t,e,i){for(var o=0;o<t.length;o+=1)if(t[o][e]===i)return o;return-1}function o(t){if(0===t.length)return-1;for(var e=t[0],i=0,o=1;o<t.length;o++)t[o]>e&&(i=o,e=t[o]);return i}function r(t,e){return t>e-1?t-e:t<0?e+t:t}function a(t,e){if(!t){if(e=e||"Assertion failed","undefined"!=typeof Error)throw new Error(e);throw e}}if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var n=[0,1,2,3,4,5,6,7,8,9];a(9==r(9,n.length)),a(0==r(10,n.length)),a(1==r(11,n.length)),a(0==r(0,n.length)),a(9==r(-1,n.length)),a(8==r(-2,n.length)),AFRAME.registerComponent("select-bar",{schema:{controls:{type:"boolean",default:!0},controllerID:{type:"string",default:"rightController"},selectedOptgroupValue:{type:"string"},selectedOptgroupIndex:{type:"int",default:0},selectedOptionValue:{type:"string"},selectedOptionIndex:{type:"int",default:0}},makeSelectOptionsRow:function(t,e,o,r,a){var n=document.createElement("a-entity");console.log(a),console.log("this.attrName"+this.attrName),console.log("this.id"+this.id),n.id=a+"optgroupLabel"+o,n.setAttribute("position","0.07 "+(.045+r)+" -0.003"),n.setAttribute("scale","0.5 0.5 0.5"),n.setAttribute("text","value",t.getAttribute("label")),n.setAttribute("text","color","#747474"),e.appendChild(n);var s=t.getElementsByTagName("option"),l=Array.prototype.slice.call(s),d=l.slice(0,4),u=l.slice(-3),m=u.concat(d),c="",p=-.225,h=.075;m.forEach(function(e,o){var n=0!==o&&6!==o,s=3===o,d=i(l,"value",e.getAttribute("value"));c+='\n      <a-entity id="'+a+d+'" visible="'+n+'" class="preview'+(s?" selected":"")+'" optionid="'+d+'" value="'+e.getAttribute("value")+'" optgroup="'+t.getAttribute("value")+'" position="'+p+" "+r+' 0">\n        <a-box class="previewFrame" position="0 0 -0.003" scale="0.06 0.06 0.005" material="color: '+(s?"yellow":"#222222")+'"></a-box>\n        <a-image class="previewImage" scale="0.05 0.05 0.05" src="'+e.getAttribute("src")+'" ></a-image>\n        <a-entity class="objectName" position="0.065 -0.04 -0.003" scale="0.18 0.18 0.18" text="value: '+e.text+"; color: "+(s?"yellow":"#747474")+'"></a-entity>\n      </a-entity>',p+=h});var v=document.createElement("a-entity");v.id=a+"selectOptionsRow"+o,v.innerHTML=c,e.appendChild(v)},init:function(){var t=this.el;this.data.lastTime=new Date,this.idPrefix=t.id?t.id:"menu";var e=document.createElement("a-entity");e.id=this.idPrefix+"selectRender",e.innerHTML='\n      <a-box id="'+this.idPrefix+'Frame" scale="0.4 0.15 0.005" position="0 0 -0.0075"  material="opacity: 0.5; transparent: true; color: #000000"></a-box>\n      <a-entity id="'+this.idPrefix+'arrowRight" position="0.225 0 0" rotation="90 180 0" scale="-0.004 0.002 0.004" obj-model="obj:#env_arrow" material="opacity: 0.5; transparent: true; color: #000000"></a-entity>\n      <a-entity id="'+this.idPrefix+'arrowLeft" position="-0.225 0 0" rotation="90 180 0" scale="0.004 0.002 0.004" obj-model="obj:#env_arrow" material="opacity:0.5; transparent:true; color:#000000"></a-entity>\n      <a-entity id="'+this.idPrefix+'arrowUp" position="0 0.1 0" rotation="0 270 90" scale="0.004 0.002 0.004" obj-model="obj:#env_arrow" material="opacity: 0.5; transparent: true; color: #000000"></a-entity>\n      <a-entity id="'+this.idPrefix+'arrowDown" position="0 -0.1 0" rotation="0 270 90" scale="-0.004 0.002 0.004" obj-model="obj:#env_arrow" material="opacity: 0.5; transparent: true; color: #000000"></a-entity>\n      ',t.appendChild(e);var i=t.getElementsByTagName("optgroup"),o=i[this.data.selectedOptgroupIndex];this.data.selectedOptgroupValue=o.getAttribute("value"),console.log(this.idPrefix),console.log("this.attrName: "+this.attrName),console.log("this.id: "+this.id),this.makeSelectOptionsRow(o,e,this.data.selectedOptgroupIndex,0,this.idPrefix)},removeSelectOptionsRow:function(t){for(var e=document.getElementById(this.idPrefix+"selectOptionsRow"+t),i=document.getElementById(this.idPrefix+"optgroupLabel"+t);e.firstChild;)e.removeChild(e.firstChild);i.parentNode.removeChild(i),e.parentNode.removeChild(e)},addEventListeners:function(){if(this.data.controls&&this.data.controllerID){var t=document.getElementById(this.data.controllerID);t.addEventListener("trackpaddown",this.onTrackpadDown.bind(this)),t.addEventListener("axismove",this.onAxisMove.bind(this)),t.addEventListener("triggerdown",this.onTriggerDown.bind(this))}var e=this.el;e.addEventListener("onHoverLeft",this.onHoverLeft.bind(this)),e.addEventListener("onHoverRight",this.onHoverRight.bind(this)),e.addEventListener("onOptionSwitch",this.onOptionSwitch.bind(this)),e.addEventListener("onOptionNext",this.onOptionNext.bind(this)),e.addEventListener("onOptionPrevious",this.onOptionPrevious.bind(this)),e.addEventListener("onOptgroupNext",this.onOptgroupNext.bind(this)),e.addEventListener("onOptgroupPrevious",this.onOptgroupPrevious.bind(this))},removeEventListeners:function(){if(this.data.controls&&this.data.controllerID){var t=document.getElementById(this.data.controllerID);t.removeEventListener("trackpaddown",this.onTrackpadDown),t.removeEventListener("axismove",this.onAxisMove),t.removeEventListener("triggerdown",this.onTriggerDown)}var e=this.el;e.removeEventListener("onOptionSwitch",this.onOptionSwitch),e.removeEventListener("onHoverRight",this.onHoverRight),e.removeEventListener("onHoverLeft",this.onHoverLeft),e.removeEventListener("onOptionNext",this.onOptionNext),e.removeEventListener("onOptionPrevious",this.onOptionPrevious),e.removeEventListener("onOptgroupNext",this.onOptgroupNext),e.removeEventListener("onOptgroupPrevious",this.onOptgroupPrevious)},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.removeEventListeners()},onTriggerDown:function(t){t.target.id==this.data.controllerID&&this.el.emit("menuSelected")},onAxisMove:function(t){if(t.target.id==this.data.controllerID&&(0!==t.detail.axis[0]||0!==t.detail.axis[1])){var e=!1,i=navigator.getGamepads();if(i)for(var o=0;o<i.length;o++){var r=i[o];r&&0===r.id.indexOf("Oculus Touch")&&(e=!0)}if(Math.abs(t.detail.axis[0])>Math.abs(t.detail.axis[1]))t.detail.axis[0]>0?this.onHoverRight():this.onHoverLeft();else{if(e)var a=-t.detail.axis[1];else var a=t.detail.axis[1];a>0?this.onHoverUp():this.onHoverDown()}var i=navigator.getGamepads();if(i)for(var o=0;o<i.length;o++){var r=i[o];if(r&&0===r.id.indexOf("Oculus Touch")&&(Math.abs(t.detail.axis[0])>.85||Math.abs(t.detail.axis[1])>.85)){var n=new Date;return void(Math.floor(n-this.data.lastTime)>500&&(this.data.lastTime=n,this.onTrackpadDown(t)))}}}},onHoverRight:function(){this.el.emit("menuHoverRight");var t=document.getElementById(this.idPrefix+"arrowRight"),e=new THREE.Color(t.getAttribute("material").color);0===e.r&&(t.removeAttribute("animation__color"),t.removeAttribute("animation__opacity"),t.setAttribute("animation__color",{property:"material.color",dur:500,from:"#00FF00",to:"#000000"}),t.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}))},onHoverLeft:function(){this.el.emit("menuHoverLeft");var t=document.getElementById(this.idPrefix+"arrowLeft"),e=new THREE.Color(t.getAttribute("material").color);0===e.r&&(t.removeAttribute("animation__color"),t.removeAttribute("animation__opacity"),t.setAttribute("animation__color",{property:"material.color",dur:500,from:"#00FF00",to:"#000000"}),t.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}))},onHoverDown:function(){this.el.emit("menuHoverDown");var t=this.el,e=t.getElementsByTagName("optgroup");console.log(this.idPrefix+"arrowDown");var i=document.getElementById(this.idPrefix+"arrowDown"),o=new THREE.Color(i.getAttribute("material").color);if(!(o.r>0&&o.g>0)){if(this.data.selectedOptgroupIndex+2>e.length)var r="#FF0000";else var r="#00FF00";i.removeAttribute("animation__color"),i.removeAttribute("animation__opacity"),i.setAttribute("animation__color",{property:"material.color",dur:500,from:r,to:"#000000"}),i.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"})}},onHoverUp:function(){this.el.emit("menuHoverUp");var t=this.el,e=(t.getElementsByTagName("optgroup"),document.getElementById(this.idPrefix+"arrowUp")),i=new THREE.Color(e.getAttribute("material").color);if(!(i.r>0&&i.g>0)){if(this.data.selectedOptgroupIndex-1<0)var o="#FF0000";else var o="#00FF00";e.removeAttribute("animation__color"),e.removeAttribute("animation__opacity"),e.setAttribute("animation__color",{property:"material.color",dur:500,from:o,to:"#000000"}),e.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"})}},onOptionNext:function(t){this.onOptionSwitch("next")},onOptionPrevious:function(t){this.onOptionSwitch("previous")},onOptgroupNext:function(t){var e=this.el,i=e.getElementsByTagName("optgroup"),o=document.getElementById(this.idPrefix+"selectRender");if(this.data.selectedOptgroupIndex+2>i.length){var r=document.getElementById(this.idPrefix+"arrowDown");r.removeAttribute("animation__color"),r.removeAttribute("animation__opacity"),r.removeAttribute("animation__scale"),r.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FF0000",to:"#000000"}),r.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),r.setAttribute("animation__scale",{property:"scale",dur:500,from:"-0.006 0.003 0.006",to:"-0.004 0.002 0.004"})}else{this.removeSelectOptionsRow(this.data.selectedOptgroupIndex),this.data.selectedOptgroupIndex+=1;var a=i[this.data.selectedOptgroupIndex];this.data.selectedOptgroupValue=a.getAttribute("value"),this.el.flushToDOM();var n=i[this.data.selectedOptgroupIndex];this.makeSelectOptionsRow(n,o,this.data.selectedOptgroupIndex,0,this.idPrefix);var s=document.getElementById(this.idPrefix+"selectOptionsRow"+this.data.selectedOptgroupIndex),l=s.getElementsByClassName("selected")[0];this.data.selectedOptionValue=l.getAttribute("value"),this.data.selectedOptionIndex=l.getAttribute("optionid"),this.el.flushToDOM(),this.el.emit("menuOptgroupNext"),this.el.emit("menuChanged");var r=document.getElementById(this.idPrefix+"arrowDown");r.removeAttribute("animation__color"),r.removeAttribute("animation__opacity"),r.removeAttribute("animation__scale"),r.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FFFF00",to:"#000000"}),r.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),r.setAttribute("animation__scale",{property:"scale",dur:500,from:"-0.006 0.003 0.006",to:"-0.004 0.002 0.004"})}},onOptgroupPrevious:function(t){var e=this.el,i=e.getElementsByTagName("optgroup"),o=document.getElementById(this.idPrefix+"selectRender");if(this.data.selectedOptgroupIndex-1<0){var r=document.getElementById(this.idPrefix+"arrowUp");r.removeAttribute("animation__color"),r.removeAttribute("animation__opacity"),r.removeAttribute("animation__scale"),r.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FF0000",to:"#000000"}),r.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),r.setAttribute("animation__scale",{property:"scale",dur:500,from:"0.006 0.003 0.006",to:"0.004 0.002 0.004"})}else{this.removeSelectOptionsRow(this.data.selectedOptgroupIndex),this.data.selectedOptgroupIndex-=1;var a=i[this.data.selectedOptgroupIndex];this.data.selectedOptgroupValue=a.getAttribute("value"),this.el.flushToDOM();var n=i[this.data.selectedOptgroupIndex];this.makeSelectOptionsRow(n,o,this.data.selectedOptgroupIndex,0,this.idPrefix);var s=document.getElementById(this.idPrefix+"selectOptionsRow"+this.data.selectedOptgroupIndex),l=s.getElementsByClassName("selected")[0];this.data.selectedOptionValue=l.getAttribute("value"),this.data.selectedOptionIndex=l.getAttribute("optionid"),this.el.flushToDOM(),this.el.emit("menuOptgroupNext"),this.el.emit("menuChanged");var r=document.getElementById(this.idPrefix+"arrowUp");r.removeAttribute("animation__color"),r.removeAttribute("animation__opacity"),r.removeAttribute("animation__scale"),r.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FFFF00",to:"#000000"}),r.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),r.setAttribute("animation__scale",{property:"scale",dur:500,from:"0.006 0.003 0.006",to:"0.004 0.002 0.004"})}},onTrackpadDown:function(t){if(t.target.id==this.data.controllerID){var e=new THREE.Color(document.getElementById(this.idPrefix+"arrowUp").getAttribute("material").color),i=new THREE.Color(document.getElementById(this.idPrefix+"arrowRight").getAttribute("material").color),r=new THREE.Color(document.getElementById(this.idPrefix+"arrowDown").getAttribute("material").color),a=new THREE.Color(document.getElementById(this.idPrefix+"arrowLeft").getAttribute("material").color),n=[e.g,i.g,r.g,a.g];if(n.reduce(function(t,e){return t+e},0)>0)switch(o(n)){case 0:return this.onOptgroupPrevious(),void console.log("PRESSup");case 1:return this.onOptionSwitch("next"),void console.log("PRESSright");case 2:return this.onOptgroupNext(),void console.log("PRESSdown");case 3:return this.onOptionSwitch("previous"),void console.log("PRESSleft")}}},onOptionSwitch:function(t){console.log(this),console.log(this.data),console.log(this.idPrefix+"selectOptionsRow"+this.data.selectedOptgroupIndex);var e=document.getElementById(this.idPrefix+"selectOptionsRow"+this.data.selectedOptgroupIndex),i=e.getElementsByClassName("selected")[0],o=parseInt(i.getAttribute("optionid")),a=o,n=this.el,s=n.getElementsByTagName("optgroup"),l=s[this.data.selectedOptgroupIndex];if("previous"==t){this.el.emit("menuPrevious"),a=r(a-=1,l.childElementCount);var d=document.getElementById(this.idPrefix+"arrowLeft");d.removeAttribute("animation__color"),d.removeAttribute("animation__opacity"),d.removeAttribute("animation__scale"),d.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FFFF00",to:"#000000"}),d.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),d.setAttribute("animation__scale",{property:"scale",dur:500,from:"0.006 0.003 0.006",to:"0.004 0.002 0.004"});var u=e.querySelectorAll("[optionid='"+a+"']")[0];if(i.classList.remove("selected"),u.classList.add("selected"),this.data.selectedOptionValue=u.getAttribute("value"),console.log(this.data.selectedOptionValue),this.data.selectedOptionIndex=a,this.el.flushToDOM(),this.el.emit("menuChanged"),i.getElementsByClassName("objectName")[0].setAttribute("text","color","gray"),u.getElementsByClassName("objectName")[0].setAttribute("text","color","yellow"),i.getElementsByClassName("previewFrame")[0].setAttribute("material","color","#222222"),u.getElementsByClassName("previewFrame")[0].setAttribute("material","color","yellow"),e.hasAttribute("desiredPosition"))var m=e.getAttribute("desiredPosition"),c=parseFloat(m.split(" ")[0])+.075,p=c.toString()+" "+m.split(" ")[1]+" "+m.split(" ")[2];else var m=e.object3D.position,c=m.x+.075,p=c.toString()+" "+m.y+" "+m.z;e.removeAttribute("animation__slide"),e.setAttribute("animation__slide",{property:"position",dur:500,from:m,to:p}),e.setAttribute("desiredPosition",p);var h=r(o-3,l.childElementCount),v=e.querySelectorAll("[optionid='"+h+"']")[0];v.setAttribute("visible","true"),v.removeAttribute("animation"),v.setAttribute("animation",{property:"scale",dur:500,from:"0.5 0.5 0.5",to:"1.0 1.0 1.0"}),v.flushToDOM();var g=r(o+3,l.childElementCount),b=e.querySelectorAll("[optionid='"+g+"']")[0];b.flushToDOM(),b.parentNode.removeChild(b);var f=r(o+2,l.childElementCount),y=e.querySelectorAll("[optionid='"+f+"']")[0];y.setAttribute("visible","false"),y.flushToDOM();var A=v.cloneNode(!0);A.setAttribute("visible","false");var x=r(o-4,l.childElementCount),_=l.children[x];A.setAttribute("optionid",x),A.setAttribute("id",this.idPrefix+x),A.setAttribute("value",_.getAttribute("value"));var E=v.object3D.position;A.setAttribute("position",E.x-.075+" "+E.y+" "+E.z),A.flushToDOM(),e.insertBefore(A,e.firstChild);var O=e.querySelectorAll("[optionid='"+x+"']")[0];O.getElementsByClassName("previewImage")[0].setAttribute("src",_.getAttribute("src")),O.getElementsByClassName("objectName")[0].setAttribute("text","value",_.text),O.getElementsByClassName("objectName")[0].setAttribute("text","color","#747474"),O.flushToDOM()}else{this.el.emit("menuNext"),a=r(a+=1,l.childElementCount);var w=document.getElementById(this.idPrefix+"arrowRight");w.removeAttribute("animation__color"),w.removeAttribute("animation__opacity"),w.removeAttribute("animation__scale"),w.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FFFF00",to:"#000000"}),w.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),w.setAttribute("animation__scale",{property:"scale",dur:500,from:"-0.006 0.003 0.006",to:"-0.004 0.002 0.004"});var I=e.querySelectorAll("[optionid='"+a+"']")[0];if(i.classList.remove("selected"),I.classList.add("selected"),this.data.selectedOptionValue=I.getAttribute("value"),console.log(this.data.selectedOptionValue),this.data.selectedOptionIndex=a,this.el.flushToDOM(),this.el.emit("menuChanged"),i.getElementsByClassName("objectName")[0].setAttribute("text","color","gray"),I.getElementsByClassName("objectName")[0].setAttribute("text","color","yellow"),i.getElementsByClassName("previewFrame")[0].setAttribute("material","color","#222222"),I.getElementsByClassName("previewFrame")[0].setAttribute("material","color","yellow"),e.hasAttribute("desiredPosition"))var m=e.getAttribute("desiredPosition"),c=parseFloat(m.split(" ")[0])-.075,p=c.toString()+" "+m.split(" ")[1]+" "+m.split(" ")[2];else var m=e.object3D.position,c=m.x-.075,p=c.toString()+" "+m.y+" "+m.z;e.removeAttribute("animation__slide"),e.setAttribute("animation__slide",{property:"position",dur:500,from:m,to:p}),e.setAttribute("desiredPosition",p);var h=r(o+3,l.childElementCount),v=e.querySelectorAll("[optionid='"+h+"']")[0];v.setAttribute("visible","true"),v.removeAttribute("animation"),v.setAttribute("animation",{property:"scale",dur:500,from:"0.5 0.5 0.5",to:"1.0 1.0 1.0"}),v.flushToDOM();var g=r(o-3,l.childElementCount),b=e.querySelectorAll("[optionid='"+g+"']")[0];b.flushToDOM(),b.parentNode.removeChild(b);var f=r(o-2,l.childElementCount),y=e.querySelectorAll("[optionid='"+f+"']")[0];y.setAttribute("visible","false"),y.flushToDOM();var A=v.cloneNode(!0);A.setAttribute("visible","false");var x=r(o+4,l.childElementCount),_=l.children[x];A.setAttribute("optionid",x),A.setAttribute("id",this.idPrefix+x),A.setAttribute("value",_.getAttribute("value"));var E=v.object3D.position;A.setAttribute("position",E.x+.075+" "+E.y+" "+E.z),A.flushToDOM(),e.insertBefore(A,e.firstChild);var O=e.querySelectorAll("[optionid='"+x+"']")[0];O.getElementsByClassName("previewImage")[0].setAttribute("src",_.getAttribute("src")),O.getElementsByClassName("objectName")[0].setAttribute("text","value",_.text),O.getElementsByClassName("objectName")[0].setAttribute("text","color","#747474"),O.flushToDOM()}}})}]);